# 📖 用戶手冊 - Novel AI 推演引擎

## 目錄

1. [快速配置](#快速配置)
2. [功能介紹](#功能介紹)
3. [使用教程](#使用教程)
4. [API 預算控制](#api-預算控制)
5. [常見問題](#常見問題)

---

## 快速配置

### 唯一需要修改的地方

打開 `config.js` 文件，找到這一行：

```javascript
XAI_API_KEY: "xai-YOUR_API_KEY_HERE",
```

將 `xai-YOUR_API_KEY_HERE` 替換為你的實際 API Key：

```javascript
XAI_API_KEY: "xai-abc123def456...",  // 你的真實 Key
```

### 獲取 xAI API Key

1. 訪問 [console.x.ai](https://console.x.ai/)
2. 登錄或註冊帳號
3. 創建新的 API Key
4. 複製 Key 到 config.js

### 啟動服務

```bash
# 安裝依賴
npm install

# 啟動
npm start

# 訪問
http://localhost:3000
```

---

## 功能介紹

### 🎭 角色扮演模式

讓 AI 扮演小說中的角色與你對話。

**支持的角色來源：**
- 恐怖驚悚類：82 本（史蒂芬·金、蔡駿等作品）
- 推理懸疑類：165 本（東野圭吾、阿加莎等）
- 盜墓探險類：89 本（鬼吹燈、盜墓筆記等）
- 網絡小說類：145 本
- 古代言情類：25 本
- 其他類型：510 本

**示例對話：**
```
用戶: 你好，胡八一，聽說你經歷過很多詭異的事？

AI (胡八一): 詭異？那可多了去了。我當年在雲南插隊的時候，
那百眼窟裡的事兒，現在想起來後背還發涼。你要是膽子大，
我給你講講精絕古城那趟...
```

### 🔀 劇情分支模式

探索「如果...會怎樣」的替代劇情。

**示例：**
```
用戶: 如果《盜墓筆記》中，吳邪第一次就拒絕了三叔的邀請，
後面的故事會怎樣發展？

AI: [基於原著設定，推演吳三省獨自行動的後果，
以及吳邪可能被迫捲入的其他方式...]
```

### 🌐 跨作品模式

讓不同作品的角色相遇。

**示例：**
```
用戶: 讓福爾摩斯來調查《白夜行》中的案件

AI: [融合福爾摩斯的推理風格和《白夜行》的案件細節，
創造全新的偵探故事...]
```

### ✍️ 風格遷移模式

用某作者的風格續寫其他故事。

**示例：**
```
用戶: 用史蒂芬·金的恐怖風格，續寫《鬼吹燈》的一個章節

AI: [融合史蒂芬·金的心理恐怖描寫技法，
創作一段盜墓主題的驚悚故事...]
```

---

## 使用教程

### 基礎對話

1. 打開網頁界面
2. 選擇或搜索一本小說
3. 選擇推演模式
4. 開始對話

### 高級技巧

#### 1. 指定場景
```
用戶: 場景：精絕古城的鬼洞，時間：深夜
角色：胡八一、王胖子、Shirley楊
情境：剛發現一具詭異的乾屍

請開始推演他們的對話和行動
```

#### 2. 控制劇情走向
```
用戶: 在接下來的推演中，我希望：
1. 增加懸疑氣氛
2. 出現一個意想不到的轉折
3. 保持原著角色的性格特點
```

#### 3. 多角色互動
```
用戶: 讓以下角色進行圓桌會議：
- 胡八一（鬼吹燈）
- 吳邪（盜墓筆記）
- 張起靈（盜墓筆記）
- 雷厲（心理罪）

話題：討論如何應對一個超自然事件
```

---

## API 預算控制

### 預算：$30 / 3小時極限燒法

#### 模型選擇策略

| 場景 | 推薦模型 | 原因 |
|------|----------|------|
| 初步探索 | grok-2-mini | 便宜 60 倍 |
| 精品推演 | grok-2 | 高質量輸出 |
| 長篇創作 | grok-2 | 連貫性更好 |
| 測試功能 | grok-2-mini | 節省成本 |

#### 成本估算

**grok-2-mini（推薦大量使用）：**
- 輸入: $0.10/1M tokens
- 輸出: $0.50/1M tokens
- $30 預算 ≈ 3000-5000 輪對話

**grok-2（精品使用）：**
- 輸入: $2/1M tokens  
- 輸出: $10/1M tokens
- $30 預算 ≈ 150-200 輪深度對話

#### 推薦混合策略

```
預算分配：
├── grok-2-mini: $10 → 探索、測試、大量互動
└── grok-2: $20 → 精品推演、長篇創作
```

### 在 config.js 中切換模型

```javascript
// 使用高質量模型
MODEL: "grok-2",

// 或使用經濟模型
MODEL: "grok-2-mini",
```

---

## 常見問題

### Q: API Key 無效怎麼辦？

1. 確認 Key 以 `xai-` 開頭
2. 確認 Key 沒有多餘空格
3. 確認帳戶有餘額
4. 重新生成一個新 Key

### Q: 回應太慢？

1. 減少 `MAX_TOKENS` 值
2. 切換到 `grok-2-mini`
3. 簡化你的提示詞

### Q: 角色不夠像原著？

在對話前添加背景設定：
```
用戶: 你是《鬼吹燈》中的胡八一，請記住以下特點：
- 東北話口音
- 經常引用《十六字陰陽風水秘術》
- 和王胖子是老戰友
- 性格沉穩但不失幽默
```

### Q: 如何節省 API 成本？

1. 使用 grok-2-mini 進行大部分對話
2. 只在關鍵劇情使用 grok-2
3. 減少每次對話的 MAX_TOKENS
4. 避免發送過長的上下文

### Q: 支持哪些小說？

全部 1016 本，按分類：

| 分類 | 數量 | 代表作品 |
|------|------|----------|
| 推理懸疑 | 165 | 東野圭吾系列、阿加莎系列 |
| 盜墓探險 | 89 | 鬼吹燈、盜墓筆記、藏地密碼 |
| 恐怖驚悚 | 82 | 史蒂芬·金系列、蔡駿系列 |
| 網絡小說 | 145 | 各類網絡連載 |
| 古代言情 | 25 | 古風愛情故事 |
| 其他 | 510 | 綜合類型 |

---

## 技術支持

- **GitHub Issues**: [web3-ai-game/db](https://github.com/web3-ai-game/db/issues)
- **項目主頁**: [README.md](./README.md)

---

*祝你推演愉快！🎭📚*
